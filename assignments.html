<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Course homepage for CS 489 Big Data Infrastructure (Winter 2016) at the University of Waterloo">
    <meta name="author" content="Jimmy Lin">
    <title>Big Data Infrastructure</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    </style>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>


  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="index.html">Overview</a></li>
            <li><a href="syllabus.html">Syllabus</a></li>
            <li class="active"><a href="assignments.html">Assignments</a></li>
            <li><a href="software.html">Software</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="page-header">
    <div style="float: right"/><img src="images/waterloo_logo.png"/></div>
    <h1>Assignments <small>CS 489/698 Big Data Infrastructure (Winter 2016)</small></h1>
  </div>

  <div class="subnav">
    <ul class="nav nav-pills">
      <li><a href="#assignment0">0</a></li>
      <li><a href="#assignment1">1</a></li>
      <li><a href="#assignment2">2</a></li>
      <li><a href="#assignment3">3</a></li>
      <li><a href="#assignment4">4</a></li>
      <li><a href="#assignment5">5</a></li>
      <li><a href="#assignment6">6</a></li>
      <li><a href="#assignment7">7</a></li>
    </ul>
  </div>


<section id="assignment0" style="padding-top:35px">
<div>
<h3>Assignment 0: Warmup <small>due 8:00am January 12</small></h3>

<p>The purpose of this assignment is to serve as a simple warmup
exercise and to serve as a practice "dry run" for the submission
procedures of subsequent assignments. The general setup is as follows:
you will complete your assignments and check everything into a private
GitHub repo. Shortly after the assignment deadline, we'll pull your
repo for grading. Although we will be examining your solutions to
assignment 0, it will not be graded <i>per se</i>.</p>

<p>I'm assuming you already have
a <a href="http://github.com/">GitHub</a> account. If not, create one
as soon as possible. Once you've signed up for an account, go and
<a href="https://education.github.com/discount_requests/new">request
an educational account</a>. This will allow you to create private
repos for free. Please do this as soon as possible since there may be
delays in the request verification process.</p>

<h4 style="padding-top: 10px">Setting up Hadoop and Spark</h4>

<p>Hadoop and Spark are already set up in
the <code>linux.student.cs.uwaterloo.ca</code>
environment. Alternatively, you may wish to install everything locally
on your own machine. See <a href="software.html">this page</a> for
more details.</p>

<p>Bespin is a library that contains reference implementations of "big
data" algorithms in MapReduce and Spark. We'll be using it throughout
this course. Go and run
the <a href="https://github.com/lintool/bespin">Word Count in
MapReduce and Spark</a> example as shown in the Bespin README (clone
and build the repo, download the data files, run word count in both
MapReduce in Spark, and verify output). Assuming you are
using <code>linux.student.cs.uwaterloo.ca</code> (or if you have
properly set up your local environment), this task should be as simple
as copying and pasting commands from the Bespin README.</p>

<h4 style="padding-top: 10px">Time to write some code!</h4>

<p>Create a <b>private</b> repo
called <code>bigdata2016w</code>. I'm assuming that you're
already familiar with Git and GitHub, but just in case, here
is <a href="https://help.github.com/articles/create-a-repo">how you
create a repo on GitHub</a>. For "Who has access to this repository?",
make sure you click "Only the people I specify". If you've
successfully gotten an educational account (per above), you should be
able to create private repos for free. If you're not already familiar
with Git, there are plenty of good tutorials online: do a simple web
search and find one you like.</p>

<p>What you're going to do now is to copy the MapReduce word count
example into you own private repo. Start with
<a href="assignments/pom.xml">this <code>pom.xml</code></a>: copy it
into your <code>bigdata2016w</code> repo. The replace this line in
that file:</p>

<pre>
  &lt;groupId&gt;ca.uwaterloo.cs.bigdata2016w.lintool&lt;/groupId&gt;
</pre>

<p>Instead of <code>lintool</code>, substitute your GitHub
username. You'll be working in your own namespace, so in everything
that follows, substitute your own GitHub username in place
of <code>lintool</code>.</p>

<p>Next, copy:</p>

<ul>
  <li><code>bespin/src/main/java/io/bespin/java/mapreduce/wordcount/WordCount.java</code> over to
  <li><code>bigdata2016w/src/main/java/ca/uwaterloo/cs/bigdata2016w/lintool/assignment0/WordCount.java</code>.
</ul>

<p>Open up this new version of <code>WordCount.java</code> using a
text editor (or your IDE of choice) and change the Java package
to <code>ca.uwaterloo.cs.bigdata2016w.lintool.assignment0</code>.</p>

<p>Now, in the <code>bigdata2016w/</code> base directory, you should
be able to run Maven to build your package:</p>

<pre>
$ mvn clean package
</pre>

<p>Once the build succeeds, you should be able to run the word count
demo program in your own repository:</p>

<pre>
$ hadoop jar target/bigdata2016w-0.1.0-SNAPSHOT.jar \
   ca.uwaterloo.cs.bigdata2016w.lintool.assignment0.WordCount \
   -input data/Shakespeare.txt -output wc
</pre>

<p>The output should be exactly the same as the same program in
Bespin, but the difference here is that the code is now in a
repository under your control, in your own private namespace.<p>

<p>Let's make a simple modification to word count: instead of counting
words, I want to count the occurrences of two-character prefixes of
words, i.e., the first two characters. That is, I want to know how
many words begin with "aa", "ab", "ac", etc., all the way to
"zz". Create a program called <code>PrefixCount</code> in the
package <code>ca.uwaterloo.cs.bigdata2016w.lintool.assignment0</code>. I
should be able to run your program as follows:</p>

<pre>
$ hadoop jar target/bigdata2016w-0.1.0-SNAPSHOT.jar \
   ca.uwaterloo.cs.bigdata2016w.lintool.assignment0.PrefixCount \
   -input data/Shakespeare.txt -output cs489-2016w-lintool-a0-shakespeare
</pre>

<p>Answer the following questions:</p>

<p><b>Question 1.</b> In the Shakespeare collection, what are the
three most frequent two character prefixes and how many times does
each occur?</p>

<p><b>Question 2.</b> How frequent does the prefix "li" occur?</p>

<h4 style="padding-top: 10px">Turning in the Assignment</h4>

<p>At this point, you should have a GitHub
repo <code>bigdata2016w/</code> and inside the repo, you should have
the word count program copied over from Bespin and the new prefix count
implementation, along with your <code>pom.xml</code>.  Commit these
files. Next, create a file called <code>assignment1.md</code>
inside <code>bigdata2016w/</code>. In that file, put your answers to
the above questions. Use the Markdown annotation format: here's
a <a href="http://daringfireball.net/projects/markdown/basics">simple
guide</a>.</p>

<p><b>Note:</b> there is no need to commit <code>data/</code>
or <code>target/</code> (or any results that you may have generated),
so your repo should be very compact &mdash; it should only have four
files: two Java source files, <code>pom.xml</code>,
and <code>assignment1.md</code>.</p>

<p>For this and all subsequent assignments, make sure everything is on
the master branch. Push your repo to GitHub. You can verify that it's
there by logging into your GitHub account in a web browser: your
assignment should be viewable in the web interface.</p>

<p>Almost there! Add the
user <a href="https://github.com/teachtool">teachtool</a> a
collaborator to your repo so that we can access it (under settings in
the main web interface on your repo). Note: do <b>not</b> add my
primary GitHub
account <a href="https://github.com/lintool">lintool</a> as a
collaborator.</p>

<p>And that's it!</p>

<p>Just to give you an idea of how we'll be grading future
assignments: we will clone your repo, build your code:</p>

<pre>
$ mvn clean package
</pre>

<p>And then run:</p>

<pre>
$ hadoop jar target/bigdata2016w-0.1.0-SNAPSHOT.jar \
   ca.uwaterloo.cs.bigdata2016w.lintool.assignment0.PrefixCount \
   -input data/Shakespeare.txt -output cs489-2016w-lintool-a0-shakespeare
</pre>

<p>We'll make sure the data files are in the right place, and once the
code completes, we will verify the output. To make sure everything is
in the proper place, you should do a fresh clone, i.e., clone your own
repo, but in a different location, and run through these same
steps. If it works for you, it'll work for us.</p>

<p>As mentioned above, one main purpose of this assignment is to
provide a practice "dry run" of how assignments will be submitted in
the future. It is your responsibility to follow these instructions and
learn the process: we will work with you to get the process sorted out
for this assignment, but in subsequent assignments, you may be docked
points for failing to conform to our expectations.</p>

<p style="padding-top: 20px"><a href="#">Back to top</a></p>
</div>
</section>


<section id="assignment1" style="padding-top:35px">
<div>
<h3>Assignment 1: Counting in MapReduce <small>due 8:00am January 19</small></h3>

<p>By now, you should already be familiar with the Hadoop execution
environment (e.g., submitting jobs) and using Maven to organize your
assignments. You will be working in the same repo as before, except
that everything should go into the package namespace
<code>ca.uwaterloo.cs.bigdata2016w.lintool.assignment1</code>
(obviously, replace <code>lintool</code> with your actual GitHub
username.</p>

<p>Before staring this assignment, it is <i>highly recommended</i>
that you look at the implementations of bigram relative frequency and
co-occurrence matrix computation
in <a href="http://bespin.io">Bespin</a>.</p>

<p>In this assignment you'll be
computing <a href="http://en.wikipedia.org/wiki/Pointwise_mutual_information">pointwise
mutual information</a>, which is a function of two events <i>x</i>
and <i>y</i>:</p>

<p><img width="200" src="assignments/PMI.png"/></p>

<p>The larger the magnitude of PMI for <i>x</i> and <i>y</i> is,
the more information you know about the probability of seeing <i>y</i>
having just seen <i>x</i> (and vice-versa, since PMI is
symmetrical). If seeing <i>x</i> gives you no information about seeing
<i>y</i>, then <i>x</i> and <i>y</i> are independent and the PMI is
zero.</p>

<p>Your implementation should be in Java.</p>

<p>Write a program that computes the PMI of words in the
<code>data/Shakespeare.txt</code> collection that's used in the Bespin
demos and the previous assignment. To be more specific, the event
we're after is <i>x</i> occurring on a line in the file or <i>x</i>
and <i>y</i> co-occurring on a line. That is, if a line contains A, A,
B; then there is only one instance of A and B appearing together, not
two. To reduce the number of spurious pairs, we are only interested in
pairs of words that co-occur in ten or more lines. Use the same
definition of "word" as in the word count demo.</p>

<p>You will build two versions of the program (put both in
package <code>ca.uwaterloo.cs.bigdata2016w.lintool.assignment1</code>):</p>

<ol>

  <li>A "pairs" implementation. The implementation must use
  combiners. Name this implementation <code>PairsPMI</code>.</li>

  <li>A "stripes" implementation.  The implementation must use
  combiners. <code>StripesPMI</code>.</li>

</ol>

<p>Since PMI is symmetrical, PMI(x, y) = PMI(y, x). However, it's
actually easier in your implementation to compute both values, so
don't worry about duplicates. Also, use <code>TextOutputFormat</code>
so the results of your program are human readable.</p>

<p><b>Note:</b> just so everyone's answer is consistent, please use
log base 10.</p>

<p>Answer the following questions:</p>

<p><b>Question 0.</b> <i>Briefly</i> describe in prose your solution,
both the pairs and stripes implementation. For example: how many
MapReduce jobs? What are the input records? What are the intermediate
key-value pairs? What are the final output records? A paragraph for
each implementation is about the expected length.</p>

<p><b>Question 1.</b> What is the running time of the complete pairs
implementation? What is the running time of the complete stripes
implementation? (Tell me where you ran these experiments,
e.g., <code>linux.student.cs.uwaterloo.ca</code> or your own
laptop.)</p>

<p><b>Question 2.</b> Now disable all combiners. What is the running
time of the complete pairs implementation now? What is the running
time of the complete stripes implementation? (Tell me where you ran
these experiments, e.g., <code>linux.student.cs.uwaterloo.ca</code> or
your own laptop.)</p>

<p><b>Question 3.</b> How many distinct PMI pairs did you extract?</p>

<p><b>Question 4.</b> What's the pair (x, y) (or pairs if there are
ties) with the highest PMI? Write a sentence or two to explain why
such a high PMI.</p>

<p><b>Question 5.</b> What are the three words that have the highest
PMI with "tears" and "death"? And what are the PMI values?</p>

<p>Note that you can compute the answer to questions 3&mdash;5 however
you wish: a helper Java program, a Python script, command-line
manipulation, etc.</p>

<h4 style="padding-top: 10px">Turning in the Assignment</h4>

<p>Please follow these instructions carefully!</p>

<p>Make sure your repo has the following items:</p>

<ul>

<li>Similar to assignment 0, the answers to the questions go
in <code>bigdata2016w/assignment1.md</code>.</li>

<li>The pairs and stripes implementation should be in
package <code>ca.uwaterloo.cs.bigdata2016w.lintool.assignment1</code>.</li>

</ul>

<p>When grading, we will pull your repo and build your code:<p>

<pre>
$ mvn clean package
</pre>

<p>Your code should build successfully. We are then going to run your
code (for the pairs and stripes implementations, respectively):</p>

<pre>
$ hadoop jar target/bigdata2016w-0.1.0-SNAPSHOT.jar \
   ca.uwaterloo.cs.bigdata2016w.lintool.assignment1.PairsPMI \
   -input data/Shakespeare.txt -output cs489-2016w-lintool-a1-shakespeare-pairs -reducers 5

$ hadoop jar target/bigdata2016w-0.1.0-SNAPSHOT.jar \
   ca.uwaterloo.cs.bigdata2016w.lintool.assignment1.StripesPMI \
   -input data/Shakespeare.txt -output cs489-2016w-lintool-a1-shakespeare-stripes -reducers 5
</pre>

<p><b>Important:</b> Make sure that your code accepts the command-line
parameters above!<p>

<p>When you've done everything, commit to your repo and remember to
push back to origin. You should be able to see your edits in the web
interface. Before you consider the assignment "complete", I would
recommend that you verify everything above works by performing a clean
clone of your repo and going through the steps above.</p>

<p>That's it! There's no need to send me anything&mdash;I already know
your username from the first assignment. Note that everything should
be committed and pushed to origin before the deadline. Git timestamps
your commits and so I can tell if your assignment is late.</p>

<h4 style="padding-top: 10px">Hints</h4>

<ul>
  <li>Did you take a look at the implementations of bigram relative
  frequency and co-occurrence matrix computation
  in <a href="http://bespin.io">Bespin</a>?</li>

  <li>Your solution may require more than one MapReduce job.</li>

  <li>You may have to load in "side data"?</li>

  <li>My <a href="https://github.com/lintool/tools/tree/master/lintools-datatypes/">lintools-datatypes
  package</a> has <code>Writable</code> datatypes that you might find
  useful. (Feel free to use, but assignment can be completed
  without.)</li>

</ul>

<h4 style="padding-top: 10px">Grading</h4>

<p>TBA</p>

<p style="padding-top: 20px"><a href="#">Back to top</a></p>
</div>
</section>


<section id="assignment2" style="padding-top:35px">
<div>
<h3>Assignment 2: Counting in Spark <small>due 8:00am January 26</small></h3>

<p style="padding-top: 20px"><a href="#">Back to top</a></p>
</div>
</section>


<section id="assignment3" style="padding-top:35px">
<div>
<h3>Assignment 3: Inverted Indexing <small>due 8:00am February 2</small></h3>

<p>For this assignment, you will be working in the same repo as
before, except that everything should go into the package namespace
<code>ca.uwaterloo.cs.bigdata2016w.lintool.assignment3</code>
(obviously, replace <code>lintool</code> with your actual GitHub
username.</p>

<p>Look at the inverted indexing and boolean retrieval implementation
in <a href="http://bespin.io">Bespin</a>. Make sure you understand the
code. Starting from the inverted indexing
baseline <code>BuildInvertedIndex</code>, modify the indexer code in
the two following ways:</p>

<p><b>1. Index Compression.</b> The index should be compressed using
<code>VInts</code>:
see <code>org.apache.hadoop.io.WritableUtils</code>. You should also
use gap-compression techniques as appropriate.</p>

<p><b>2. Buffering postings.</b> The baseline indexer implementation
currently buffers and sorts postings in the reducer, which as we
discussed in class is not a scalable solution. Address this
scalability bottleneck using techniques we discussed in class and in
the textbook.</p>

<p><b>3. Term partitioning.</b> The baseline indexer implementation
currently uses only one reducer and therefore all postings lists are
shuffled to the same node and written to HDFS in a single
partition. Change this so we can specify the number of reducers
(hence, partitions) as a command-line argument. This is, of course,
easy to do, but we need to make sure that the searcher understands
this partitioning also.</p>

<p><b>Note:</b> The major scalability issue is
buffering <i>uncompressed</i> postings in memory. In your solution,
you'll still end up buffering each postings list, but
in <i>compressed</i> form (raw bytes, no additional object
overhead). This is fine because if you use the right compression
technique, the postings lists are quite small. As a data point, on a
collection of 50 million web pages, 2GB heap is more than enough for a
full <i>positional</i> index (and in this assignment you're not asked
to store positional information in your postings).</p>

<p>To go into a bit more detail: in the reference implementation, the
final key type is <code>PairOfWritables&lt;IntWritable,
ArrayListWritable&lt;PairOfInts&gt;&gt;</code>. The most obvious idea
is to change that into something
like <code>PairOfWritables&lt;VIntWritable,
ArrayListWritable&lt;PairOfVInts&gt;&gt;</code>. This does not work!
The reason is that you will still be materializing each posting, i.e.,
all <code>PairOfVInts</code> objects in memory. This translates into a
Java object for every posting, which is wasteful in terms of memory
usage and will exhaust memory pretty quickly as you scale. In other
words, you're <i>still</i> buffering objects&mdash;just inside
the <code>ArrayListWritable</code>.

<p>This new indexer should be
named <code>BuildInvertedIndexCompressed</code>. This new class should
be in the
package <code>ca.uwaterloo.cs.bigdata2016w.lintool.assignment3</code>. Make
sure it works on the Shakespeare.txt collection.</p>

<p>Modify <code>BooleanRetrieval</code> so that it works with the new
compressed indexes. Name this new
class <code>BooleanRetrievalCompressed</code>. This new class should
be in the same package as above and give <i>exactly</i> the same
output as the old version. That is, when grading, we
will <code>diff</code> the output of your implementation with the one
in Bespin.</p>

<!--
<p><b>Another note:</b> the <code>BooleanRetrieval</code> reference
implementation prints out the entire line (i.e., "document") that
satisfies the query. For the Shakespeare collection, this is fine
since the lines are short. However, in the simplewiki collection, the
lines (i.e., documents) are much longer, so you should somehow
truncate: either print out only the article title or the first 80
characters, or something along those lines.</p>
-->

<p>Answer the following questions:</p>

<p><b>Question 1.</b> What is the size of your compressed index for Shakespeare collection?</p>

<!--
<p><b>Question 2.</b> What is the size of your compressed index for <code>simplewiki-20141222-pages-articles.txt</code>?</p>

<p><b>Question 3.</b> Which articles in <code>simplewiki-20141222-pages-articles.txt</code> satisfy the following boolean queries?</p>

<pre>
outrageous AND fortune
means AND deceit
(white OR red ) AND rose AND pluck
(unhappy OR outrageous OR (good AND your)) AND fortune
</pre>

<p>Note that I just want the article titles only (not the actual text).</p>

-->


<h4 style="padding-top: 10px">Turning in the Assignment</h4>

<p>Please follow these instructions carefully!</p>

<p>Make sure your repo has the following items:</p>

<ul>

<li>Similar to the previous assignments, the answers to the questions go
in <code>bigdata2016w/assignment3.md</code>.</li>

<li>The pairs and stripes implementation should be in
package <code>ca.uwaterloo.cs.bigdata2016w.lintool.assignment3</code>.</li>

</ul>

<p>When grading, we will pull your repo and build your code:<p>

<pre>
$ mvn clean package
</pre>

<p>Your code should build successfully. We are then going to run your
code on the Shakesspeare collection:</p>

<pre>
$ hadoop jar target/bigdata2016w-assignments-0.1.0-SNAPSHOT.jar \
   ca.uwaterloo.cs.bigdata2016w.lintool.assignment3.BuildInvertedIndexCompressed \
   -input data/Shakespeare.txt -output cs489-2016w-lintool-a3-index-shakespeare
</pre>

<p>When grading, we will <code>diff</code> the output of your
implementation with the one in Bespin.</p>

<p>When you've done everything, commit to your repo and remember to
push back to origin. You should be able to see your edits in the web
interface. Before you consider the assignment "complete", I would
recommend that you verify everything above works by performing a clean
clone of your repo and going through the steps above.</p>

<p>That's it!</p>

<h4 style="padding-top: 10px">Grading</h4>

<p>TBA</p>

<p style="padding-top: 20px"><a href="#">Back to top</a></p>
</div>
</section>


<section id="assignment4" style="padding-top:35px">
<div>
<h3>Assignment 4: PageRank <small>due 8:00am February 9</small></h3>

<p style="padding-top: 20px"><a href="#">Back to top</a></p>
</div>
</section>


<section id="assignment5" style="padding-top:35px">
<div>
<h3>Assignment 5: Data Warehousing <small>due 8:00am March 1</small></h3>

<p style="padding-top: 20px"><a href="#">Back to top</a></p>
</div>
</section>


<section id="assignment6" style="padding-top:35px">
<div>
<h3>Assignment 6: Duplicate Sentence Detection <small>due 8:00am March 15</small></h3>

<p style="padding-top: 20px"><a href="#">Back to top</a></p>
</div>
</section>


<section id="assignment7" style="padding-top:35px">
<div>
<h3>Assignment 7: Inverted Indexing (Redux) <small>due 8:00am March 22</small></h3>

<p style="padding-top: 20px"><a href="#">Back to top</a></p>
</div>
</section>

<p style="padding-top:100px" />

    </div><!-- /.container -->


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>
  </body>

</html>
